"use strict";!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n((t=t||self).HistoryLibrary={})}(this,(function(t){function n(){return(n=Object.assign||function(t){for(var n=1;n<arguments.length;n++){var e,r=arguments[n];for(e in r)Object.prototype.hasOwnProperty.call(r,e)&&(t[e]=r[e])}return t}).apply(this,arguments)}function e(t){t.preventDefault(),t.returnValue=""}function r(){var t=[];return{get length(){return t.length},push:function(n){return t.push(n),function(){t=t.filter((function(t){return t!==n}))}},call:function(n){t.forEach((function(t){return t&&t(n)}))}}}function o(){return Math.random().toString(36).substr(2,8)}function a(t){var n=t.pathname,e=t.search;return(void 0===n?"/":n)+(void 0===e?"":e)+(void 0===(t=t.hash)?"":t)}function i(t){var n={};if(t){var e=t.indexOf("#");0<=e&&(n.hash=t.substr(e),t=t.substr(0,e)),0<=(e=t.indexOf("?"))&&(n.search=t.substr(e),t=t.substr(0,e)),t&&(n.pathname=t)}return n}t.createBrowserHistory=function(t){function u(){var t=h.location,n=d.state||{};return[n.idx,{pathname:t.pathname,search:t.search,hash:t.hash,state:n.usr||null,key:n.key||"default"}]}function c(t){return"string"==typeof t?t:a(t)}function l(t,e){return void 0===e&&(e=null),n({},g,{},"string"==typeof t?i(t):t,{state:e,key:o()})}function f(t){p=t,t=u(),y=t[0],g=t[1],b.call({action:p,location:g})}function s(t){d.go(t)}var h=void 0===(t=(void 0===t?{}:t).window)?document.defaultView:t,d=h.history,v=null;h.addEventListener("popstate",(function(){if(v)P.call(v),v=null;else{var t=u(),n=t[0];if(t=t[1],P.length){if(null!=n){var e=y-n;e&&(v={action:"POP",location:t,retry:function(){s(-1*e)}},s(e))}}else f("POP")}}));var p="POP",y=(t=u())[0],g=t[1],P=r(),b=r();return null==y&&(y=0,d.replaceState(n({},d.state,{idx:y}),null)),{get action(){return p},get location(){return g},createHref:c,push:function t(n,e){var r=l(n,e);if(!P.length||(P.call({action:"PUSH",location:r,retry:function(){t(n,e)}}),0)){var o=[{usr:r.state,key:r.key,idx:y+1},c(r)];r=o[0],o=o[1];try{d.pushState(r,null,o)}catch(t){h.location.assign(o)}f("PUSH")}},replace:function t(n,e){var r=l(n,e);P.length&&(P.call({action:"REPLACE",location:r,retry:function(){t(n,e)}}),1)||(r=[{usr:r.state,key:r.key,idx:y},c(r)],d.replaceState(r[0],null,r[1]),f("REPLACE"))},go:s,back:function(){s(-1)},forward:function(){s(1)},listen:function(t){return b.push(t)},block:function(t){var n=P.push(t);return 1===P.length&&h.addEventListener("beforeunload",e),function(){n(),P.length||h.removeEventListener("beforeunload",e)}}}},t.createHashHistory=function(t){function u(){var t=i(d.location.hash.substr(1)),n=t.pathname,e=t.search;t=t.hash;var r=v.state||{};return[r.idx,{pathname:void 0===n?"/":n,search:void 0===e?"":e,hash:void 0===t?"":t,state:r.usr||null,key:r.key||"default"}]}function c(){if(p)b.call(p),p=null;else{var t=u(),n=t[0];if(t=t[1],b.length){if(null!=n){var e=g-n;e&&(p={action:"POP",location:t,retry:function(){h(-1*e)}},h(e))}}else s("POP")}}function l(t){var n=document.querySelector("base"),e="";return n&&n.getAttribute("href")&&(e=-1===(e=(n=d.location.href).indexOf("#"))?n:n.slice(0,e)),e+"#"+("string"==typeof t?t:a(t))}function f(t,e){return void 0===e&&(e=null),n({},P,{},"string"==typeof t?i(t):t,{state:e,key:o()})}function s(t){y=t,t=u(),g=t[0],P=t[1],k.call({action:y,location:P})}function h(t){v.go(t)}var d=void 0===(t=(void 0===t?{}:t).window)?document.defaultView:t,v=d.history,p=null;d.addEventListener("popstate",c),d.addEventListener("hashchange",(function(t){a(u()[1])!==a(P)&&c()}));var y="POP",g=(t=u())[0],P=t[1],b=r(),k=r();return null==g&&(g=0,v.replaceState(n({},v.state,{idx:g}),null)),{get action(){return y},get location(){return P},createHref:l,push:function t(n,e){var r=f(n,e);if(!b.length||(b.call({action:"PUSH",location:r,retry:function(){t(n,e)}}),0)){var o=[{usr:r.state,key:r.key,idx:g+1},l(r)];r=o[0],o=o[1];try{v.pushState(r,null,o)}catch(t){d.location.assign(o)}s("PUSH")}},replace:function t(n,e){var r=f(n,e);b.length&&(b.call({action:"REPLACE",location:r,retry:function(){t(n,e)}}),1)||(r=[{usr:r.state,key:r.key,idx:g},l(r)],v.replaceState(r[0],null,r[1]),s("REPLACE"))},go:h,back:function(){h(-1)},forward:function(){h(1)},listen:function(t){return k.push(t)},block:function(t){var n=b.push(t);return 1===b.length&&d.addEventListener("beforeunload",e),function(){n(),b.length||d.removeEventListener("beforeunload",e)}}}},t.createMemoryHistory=function(t){function e(t,e){return void 0===e&&(e=null),n({},v,{},"string"==typeof t?i(t):t,{state:e,key:o()})}function u(t,n,e){return!p.length||(p.call({action:t,location:n,retry:e}),!1)}function c(t,n){d=t,v=n,y.call({action:d,location:v})}function l(t){var n=Math.min(Math.max(h+t,0),s.length-1),e=s[n];u("POP",e,(function(){l(t)}))&&(h=n,c("POP",e))}var f=void 0===t?{}:t;t=f.initialEntries,f=void 0===(f=f.initialIndex)?0:f;var s=(void 0===t?["/"]:t).map((function(t){return n({pathname:"/",search:"",hash:"",state:null,key:o()},"string"==typeof t?i(t):t)})),h=Math.min(Math.max(f,0),s.length-1),d="POP",v=s[h],p=r(),y=r();return{get index(){return h},get action(){return d},get location(){return v},createHref:function(t){return"string"==typeof t?t:a(t)},push:function t(n,r){var o=e(n,r);u("PUSH",o,(function(){t(n,r)}))&&(h+=1,s.splice(h,s.length,o),c("PUSH",o))},replace:function t(n,r){var o=e(n,r);u("REPLACE",o,(function(){t(n,r)}))&&(s[h]=o,c("REPLACE",o))},go:l,back:function(){l(-1)},forward:function(){l(1)},listen:function(t){return y.push(t)},block:function(t){return p.push(t)}}},t.createPath=a,t.parsePath=i,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=history.production.min.js.map
